<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
</head>
<body>
    <h1>{{ title }}</h1>

    {% if abstract %}
        <h2>Abstract</h2>
        <p>{{ abstract }}</p>
    {% endif %}

    {% if subspecies %}
        <h2>Subspecies</h2>
        <ul>
            {% for item in subspecies %}
                <li>{{ item }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if ecology %}
        <h2>Ecology</h2>
        <p>{{ ecology }}</p>
    {% endif %}

    {% if taxonomy %}
        <h2>Taxonomy</h2>
        <p>{{ taxonomy }}</p>
    {% endif %}

    {% if zone %}
        <h2>Zone Name</h2>
        <p>{{ zone }}</p>
    {% endif %}

    <!-- Add a form for adding comments -->
    <h2>Add Comment</h2>
    <form method="post" action="{{ url_for('add_comment', zone_name=zone, plant_name=title) }}">
        <textarea name="comment"></textarea>
        <input type="submit" value="Add Comment">
    </form>

    {% if comments %}
        <h2>Comments</h2>
        <ul>
            {% for comment in comments %}
                <li>{{ comment }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <form action="{{ url_for('upload_image', zone_name=zone, plant_name=title) }}" method="post" enctype="multipart/form-data">
        <label for="images">Upload Images:</label>
        <input type="file" name="images" accept="image/*" multiple>
        <button type="submit">Upload</button>
    </form>

    {% if images %}
        <h2>Images</h2>
        <ul>
            {% for image_path in images %}
                <li><img src="{{ image_path }}" alt="Image"></li>
            {% endfor %}
        </ul>
    {% endif %}

    <h2>Add Relation</h2>
    <form method="post" action="{{ url_for('add_relation', zone_name=zone, plant_name=title) }}">
        <textarea name="relation"></textarea>
        <select name="near_by_option">
            {% if near_by_list %}
                {% for option in near_by_list %}
                    {% set parts = option.split('/') %}
                    {% set last_part = parts[-1] %}
                    <option value="{{ last_part }}">{{ last_part }}</option>
                {% endfor %}
            {% endif %}
        </select>
        <input type="submit" value="Add Relation">
    </form>

    {% if relations %}
    <h2>User Relations:</h2>
    <ul>
        {% for key, value in relations.items() %}
            {% set predicate_parts = key.split('/') %}
            {% set predicate_name = predicate_parts[-1]|replace('%20', ' ') %}
            {% if value is iterable and value is not string %}
                {% for obj in value %}
                    {% set object_parts = obj.split('/') %}
                    {% set object_name = object_parts[-1]|replace('%20', ' ') %}
                    <a href = {{key}}><li><strong>{{ predicate_name }}:</strong></a><a href={{obj}}> {{ object_name }}</li></a>
                {% endfor %}
            {% else %}
                {% set object_parts = value.split('/') %}
                {% set object_name = object_parts[-1]|replace('%20', ' ') %}
                <a href = {{key}}><li><strong>{{ predicate_name }}:</strong></a><a href={{value}}> {{ object_name }}</li></a>
            {% endif %}
        {% endfor %}
    </ul>
{% endif %}


</body>
</html>
